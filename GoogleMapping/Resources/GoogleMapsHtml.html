<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="cleartype" content="on"/>
    <title>Google Map</title>
    <style type="text/css">
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
        }
        div.mapCanvas {
            height:100%;
        }
        .markerLabel {
            color: navy;
            background-color: white;
            font-family: "Lucida Grande", "Arial", sans-serif;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            width: 22px;
            border: 1px solid black;
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <div class="mapCanvas" id="map" />
    <script src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script src="http://google-maps-utility-library-v3.googlecode.com/svn/tags/markerwithlabel/1.1.9/src/markerwithlabel_packed.js"></script>
    <script type="text/javascript">
        function createLatLng(lat, lng) {
            return new google.maps.LatLng(lat, lng);
        }
        /**
        * Creates a click-handler function that will show the infoWindow for a given marker.
        */
        function createFixedMarkerClickHandler(marker, infoWindow, infoContent) {
            return function() {
                infoWindow.setContent(infoContent);
                infoWindow.open(map.gmap, marker);
            }
        }
        /**
        * Returns an object literal specifying marker options for a non-draggable (fixed) marker.
        */
        function createFixedMarkerOptions(lat, lng, color, titleText, labelHtml, infoHtml) {
            //
            // See MarkerOptions reference from Google Maps API v3 - [1]
            // and MarkerWithLabelOptions reference from Google Maps Utility Libarary v3 - [2].
            //
            // [1] - https://developers.google.com/maps/documentation/javascript/reference#MarkerOptions
            // [2] https://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerwithlabel/docs/reference.html#MarkerWithLabelOptions
            //
            return {
                position: new google.maps.LatLng(lat, lng),
                icon: getIconForColor(color),
                labelContent: labelHtml,
                labelAnchor: new google.maps.Point(12, 0),
                labelClass: 'markerLabel',
                labelStyle: {opacity: 0.75},
                title: titleText,
                infoContent: infoHtml,
                raiseOnDrag: false
            };
        }
        /**
        * Returns an icon URL for the given color. Icons are generated by Google's Chart API.
        */
        function getIconForColor(color) {
            var BASE_URL = 'http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|';
            if (color === 'green')
                return BASE_URL + '64CD98';
            else if (color === 'blue')
                return BASE_URL + '3BA0F7';
            else
                return BASE_URL + 'FE7569';
        }
        /**
        * Class for a map that shows one or more markers.
        */
        function MapWithMarkers() {
            this.centerLatLng = createLatLng(0.0, 0.0);
            this.zoomLevel = 12;
            this.mapType = google.maps.MapTypeId.ROADMAP;
            this.markerOptions = [];
        }
        /**
        * Initializes the MapWithMarkers.
        */
        MapWithMarkers.prototype.initialize = function() {
            this.gmap = new google.maps.Map(document.getElementById('map'), {
                zoom: this.zoomLevel,
                center: this.centerLatLng,
                mapTypeId: this.mapType
            });
            this.infoWindow = new google.maps.InfoWindow();
            var markerOptions = this.markerOptions;
            for (i = 0; i < markerOptions.length; i++) {
                var options = markerOptions[i];
                options.map = this.gmap;
                var marker = new MarkerWithLabel(options);
                google.maps.event.addListener(marker, 'click', 
                    createFixedMarkerClickHandler(marker, this.infoWindow, markerOptions[i].infoContent));
            }
        };
        /**
        * Class for a map that allows geo-coding.
        */
        function MapForGeocoding() {
            this.address = null;
            this.addressLatLng = null;
            this.zoomLevel = 16;
            this.mapType = google.maps.MapTypeId.ROADMAP;
        }

        MapForGeocoding.prototype.handleGeocodingError = function(reason) {
            window.external.setError(reason);
        };

        MapForGeocoding.prototype.initialize = function() {
            var self = this;
            this.geocoder = new google.maps.Geocoder();
            this.gmap = new google.maps.Map(document.getElementById('map'), {
                zoom: this.zoomLevel,
                mapTypeId: this.mapType
            });
            // Create options for geocode request.
            // See https://developers.google.com/maps/documentation/javascript/reference?csw=1#GeocoderRequest
            var options = {};
            if (this.address != null && this.address.length > 0)
                options.address = this.address;
            if (this.addressLatLng != null) {
                options.location = addressLatLng;
            }
            this.geocoder.geocode(options, function(results, status) {
                if (status != google.maps.GeocoderStatus.OK)
                    return self.handleGeocodingError(status);
                var loc = results[0].geometry.location;
                self.gmap.setCenter(loc);
                self.marker = new google.maps.Marker({
                    map: self.gmap,
                    icon: getIconForColor('red'),
                    position: loc,
                    title: self.address,
                    draggable: true
                });
                // Set the host programs position right away.
                window.external.setGeocodingResult(loc.lat(), loc.lng());
                // Also update the host program anytime the marker is moved.
                google.maps.event.addListener(self.marker, 'position_changed', function() {
                    var pos = self.marker.getPosition();
                    window.external.setGeocodingResult(pos.lat(), pos.lng());
                });
            });
        };
        /**
        * Class for a map that displays directions.
        */
        function MapForDirections() {
            this.origin = null;
            this.destination = null;
            this.travelMode = google.maps.TravelMode.DRIVING;
            this.zoomLevel = 14;
            this.mapType = google.maps.MapTypeId.ROADMAP;
        }

        MapForDirections.prototype.handleRouteRequestError = function(reason) {
            window.external.setError(reason);
        };

        MapForDirections.prototype.initialize = function() {
            var self = this;
            this.directionsService = new google.maps.DirectionsService();
            this.directionsDisplay = new google.maps.DirectionsRenderer();
            this.gmap = new google.maps.Map(document.getElementById('map'), {
                zoom: this.zoomLevel,
                center: this.origin,
                mapTypeId: this.mapType
            });
            this.directionsDisplay.setMap(this.gmap);
            // Create request for directions.
            // See https://developers.google.com/maps/documentation/javascript/reference#DirectionsRequest
            var request = {
                origin: this.origin,
                destination: this.destination,
                travelMode: this.travelMode
            };
            this.directionsService.route(request, function(response, status) {
                if (status != google.maps.DirectionsStatus.OK)
                    return self.handleRouteRequestError(status);
                self.directionsDisplay.setDirections(response);
                
                for(var routeid in response.routes) {
                    var route = response.routes[routeid];
                    for(var legid in route.legs) {
                        var leg = route.legs[legid];
                        for(var stepid in leg.steps) {
                            var step = leg.steps[stepid];
                            window.external.setDirectionsResult(step.instructions);
                        }
                    }
                }
                window.external.setDirectionsCompleted();
            });
        };
    </script>
    <script type="text/javascript">
        /**
        * ---------------------------------------------------------------------
        * MapWithMarkers Example:
        * ---------------------------------------------------------------------
        var map = new MapWithMarkers();
        map.centerLatLng = createLatLng(40.42951, -86.87892);
        map.markerOptions = [
            createFixedMarkerOptions(40.42951, -86.87892, "green", 
                "TRI-US REHABILITATION CENTER",
                "1",
                "1 TRI-US REHABILITATION CENTER (7) <br/>1700 WILSON ST<br/> LAFAYETTE "
            ),
            createFixedMarkerOptions(40.43385, -86.84887, "red",
                "HOME RUN BALL PARK",
                "8",
                "8 HOME RUN BALL PARK (8) <br/>1676 PINE LANE<br/> LAFAYETTE "
            )
        ];
        map.initialize();
        */

        /**
        * ---------------------------------------------------------------------
        * MapForGeocoding Example:
        * ---------------------------------------------------------------------
        var map = new MapForGeocoding();
        map.address = '55 Gilbert St N, Tinton Falls, NJ 07701';
        // map.addressLatLng = createLatLng(40.327374, -74.075921);  // Optional
        map.initialize();
        */

        /**
        * ---------------------------------------------------------------------
        * MapForDirections Example:
        * ---------------------------------------------------------------------
        var map = new MapForDirections();
        map.origin = createLatLng(40.153826, -74.220010);       // 74 Salem Hill Road, Howell NJ 07731
        map.destination = createLatLng(40.327374, -74.075921);  // 55 Gilbert St N, Tinton Falls, NJ 07701
        map.initialize();
        */

        // The .NET code must write some Javascript that looks like one of the examples above.
        // Use the place-holder below can be used to insert the script. - WB

        // ##JAVASCRIPT-TO-INITIALIZE-MAPPING##

    </script>
</body>
</html>